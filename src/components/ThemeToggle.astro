<button
  id="theme-toggle"
  class="inline-flex items-center justify-center w-6 h-6 transition-colors duration-200 ease-in-out hover:opacity-80"
  aria-label="Toggle theme"
>
  <span class="sr-only">Toggle theme</span>
  
  <!-- Thin circle for both modes -->
  <span
    id="theme-circle"
    class="block w-4 h-4 border border-current rounded-full transition-all duration-300 ease-in-out"
    style="border-width: 1.5px; color: #18181b;"
  ></span>
  
  <style>
    html.dark #theme-circle {
      color: #e4e4e7 !important;
    }
    
    #theme-circle.fading {
      animation: fade 0.3s ease-in-out;
    }
    
    @keyframes fade {
      0% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
      100% {
        opacity: 1;
      }
    }
  </style>
</button>

<script>
  const setListener = () => {
    const button = document.getElementById("theme-toggle");
    const circle = document.getElementById("theme-circle");
    
    button?.addEventListener("click", () => {
      // Add fade animation
      circle?.classList.add("fading");
      
      // Toggle theme
      document.documentElement.classList.toggle("dark");
      
      // Remove fade class after animation completes
      setTimeout(() => {
        circle?.classList.remove("fading");
      }, 300);
    });
  };

  setListener();
  document.addEventListener("astro:after-swap", setListener);
</script>
