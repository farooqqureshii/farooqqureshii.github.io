---
// component import
import SpotifyNowPlaying from './SpotifyNowPlaying.astro';
---

<footer class="mt-12">
  <hr class="border-zinc-200 dark:border-zinc-700 mb-4" />
  <div class="flex justify-between text-xs text-zinc-500">
    <div class="flex flex-col gap-1">
      <span>crafted with care by farooq</span>
      <div class="flex items-center gap-1">
        <div class="flip-clock-container">
          <span id="calgary-time" class="flip-clock opacity-0 transition-opacity duration-300">--:--</span>
        </div>
        <span>| calgary</span>
      </div>
    </div>
    <SpotifyNowPlaying />
  </div>

  <style>
    .flip-clock-container {
      perspective: 100px;
      display: inline-block;
    }
    
    .flip-clock {
      display: inline-block;
      transition: transform 0.3s ease-out;
    }
    
    .flip-clock.flip {
      animation: flipAnimation 0.3s ease-out;
    }
    
    @keyframes flipAnimation {
      0% {
        transform: rotateX(0deg);
      }
      50% {
        transform: rotateX(90deg);
      }
      100% {
        transform: rotateX(0deg);
      }
    }
  </style>

  <script>
    let previousTime = '';
    
    function updateCalgaryTime() {
      const calgaryTime = new Date().toLocaleTimeString('en-CA', {
        timeZone: 'America/Edmonton',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      });

      const el = document.getElementById('calgary-time');
      if (el) {
        // Check if time actually changed
        if (previousTime && previousTime !== calgaryTime) {
          el.classList.add('flip');
          setTimeout(() => {
            el.classList.remove('flip');
          }, 300);
        }
        
        el.textContent = calgaryTime;
        el.classList.remove('opacity-0');
        previousTime = calgaryTime;
      }
    }

    updateCalgaryTime();
    setInterval(updateCalgaryTime, 60000);
  </script>
</footer>
